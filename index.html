<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<title>Bliźniaczy płomień</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

  :root{
    --bg1:#f6fbff; --bg2:#eef7ff; --card:#ffffff;
    --muted:#6b7c93; --accent:#7aa7ff;
  }

  *{box-sizing:border-box; margin:0; padding:0; transition: all 0.3s ease;}
  body{
    height:100vh; display:grid; place-items:center;
    font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: radial-gradient(circle at 10% 20%, rgba(122,167,255,0.12), transparent 10%),
                linear-gradient(180deg,var(--bg1),var(--bg2));
    color:#0b2035;
  }

  .card{
    width:360px; max-width:90vw; padding:28px; border-radius:16px;
    background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(250,251,255,0.95));
    box-shadow: 0 12px 40px rgba(11,32,53,0.2);
    text-align:center; border:1px solid rgba(11,32,53,0.04);
    transform: scale(0.9); opacity:0; animation: fadeIn 0.8s forwards;
  }

  @keyframes fadeIn{ to{ transform: scale(1); opacity:1; } }

  .logo{
    width:100%; height:auto; padding:14px 8px;
    border-radius:14px; margin:0 auto 18px;
    display:grid; place-items:center;
    background:linear-gradient(135deg,var(--accent), #b8d7ff);
    color:white; font-weight:700; font-size:16px;
    text-align:center; line-height:1.2; word-wrap: break-word;
    box-shadow: 0 6px 18px rgba(122,167,255,0.2);
    transform: translateY(-10px); animation: logoDrop 0.8s forwards;
  }

  @keyframes logoDrop{ to{ transform: translateY(0); } }

  h1{margin:0 0 10px;font-size:18px; color:#0b2035;}
  p.lead{margin:0 0 18px;color:var(--muted);font-size:13px;}

  input[type="password"]{
    width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(11,32,53,0.06);
    font-size:15px; outline:none; background:rgba(255,255,255,0.7);
    backdrop-filter: blur(4px); transition: all 0.3s ease;
  }
  input[type="password"]:focus{
    border-color: var(--accent); box-shadow: 0 0 12px rgba(122,167,255,0.3);
  }

  button{
    margin-top:14px;width:100%;padding:12px;border-radius:12px;border:none;
    font-weight:600;font-size:15px;cursor:pointer; background:var(--accent); color:#fff;
    box-shadow: 0 6px 18px rgba(122,167,255,0.25); transition: all 0.3s ease;
  }
  button:hover{
    transform: translateY(-3px); box-shadow: 0 10px 25px rgba(122,167,255,0.3);
  }

  .note{margin-top:14px;font-size:12px;color:var(--muted)}
  .error{color:#b83636;margin-top:10px;font-size:13px;display:none;}

  @media (max-width: 400px){
    .card{ padding:20px; border-radius:14px;}
    .logo{font-size:14px; padding:10px;}
    h1{font-size:16px;} p.lead{font-size:12px;}
    input[type="password"]{padding:10px; font-size:14px;}
    button{padding:10px; font-size:14px;}
  }
</style>
<meta http-equiv="Cache-Control" content="no-store">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
</head>
<!-- подключаем проверку -->
 <script src="auth.js"></script>
<body>
  <div class="card" role="main" aria-labelledby="title">
    <div class="logo">Bliźniaczy płomień</div>
    <h1 id="title">Enter password</h1>
    <p class="lead">Please enter the password to access your files.</p>

    <form id="gate">
      <input id="pw" type="password" placeholder="Password" autocomplete="off" required />
      <button id="btn" type="submit">Enter</button>
    </form>

    <div class="error" id="err">Incorrect password</div>
    <div class="note">Soft, private access. English only prompt.</div>
  </div>

<script>
const PASSWORD = '3861';
const TOKEN_KEY = 'auth_token';
const TOKEN_TTL_MS = 30 * 60 * 1000; // 30 минут

function generateToken(){ return Math.random().toString(36).slice(2)+Date.now().toString(36); }

const form = document.getElementById('gate');
const pwInput = document.getElementById('pw');
const errEl = document.getElementById('err');

form.addEventListener('submit', e=>{
  e.preventDefault();
  const pw = pwInput.value || '';
  if(pw === PASSWORD){
    const token = generateToken();
    const expires = Date.now() + TOKEN_TTL_MS;
    sessionStorage.setItem(TOKEN_KEY, JSON.stringify({token, expires}));
    window.location.replace('main.html'); // replace, чтобы не оставалось в истории
  } else {
    errEl.style.display = 'block';
    setTimeout(()=>errEl.style.display='none',2200);
    pwInput.value = '';
    pwInput.focus();
  }
});

// Проверка на случай, если кто-то уже на main.html
if(window.location.pathname.endsWith('main.html')){
  try{
    const raw = sessionStorage.getItem(TOKEN_KEY);
    if(!raw){ window.location.replace('index.html'); }
    const obj = JSON.parse(raw);
    if(!obj.token || !obj.expires || Date.now() > obj.expires){
      sessionStorage.removeItem(TOKEN_KEY);
      window.location.replace('index.html');
    }
  }catch(e){
    window.location.replace('index.html');
  }
}
</script>
</body>
</html>
